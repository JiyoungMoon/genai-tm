/*! For license information please see teachablemachine-image.min.js.LICENSE.txt */
var tmImage;(()=>{var t={791:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e,n){var o=n.value;if("function"!=typeof o)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(r(o)));var a=!1;return{configurable:!0,get:function(){if(a||this===t.prototype||this.hasOwnProperty(e)||"function"!=typeof o)return o;var n=o.bind(this);return a=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return n},set:function(t){o=t,delete this[e]}}),a=!1,n},set:function(t){o=t}}}function a(t){var e;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?e=Reflect.ownKeys(t.prototype):(e=Object.getOwnPropertyNames(t.prototype),"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t.prototype)))),e.forEach((function(e){if("constructor"!==e){var n=Object.getOwnPropertyDescriptor(t.prototype,e);"function"==typeof n.value&&Object.defineProperty(t.prototype,e,o(t,e,n))}})),t}function i(){return 1===arguments.length?a.apply(void 0,arguments):o.apply(void 0,arguments)}n.r(e),n.d(e,{boundClass:()=>a,boundMethod:()=>o,default:()=>i})},474:(t,e,n)=>{var r=n(898),o=n(776),a=n(920),i=n(707),s=n(655),u=n(668),c=n(64);c.alea=r,c.xor128=o,c.xorwow=a,c.xorshift7=i,c.xor4096=s,c.tychei=u,t.exports=c},898:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new i(t),r=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.alea=u}(0,t=n.nmd(t),n.amdD)},668:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,o=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new i(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.tychei=u}(0,t=n.nmd(t),n.amdD)},776:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new i(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.xor128=u}(0,t=n.nmd(t),n.amdD)},655:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this;e.next=function(){var t,n,r=e.w,o=e.X,a=e.i;return e.w=r=r+1640531527|0,n=o[a+34&127],t=o[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=o[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,o,a,i,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),o=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=s[127&a]^=r+i)?o+1:0);for(o>=128&&(s[127&(e&&e.length||0)]=-1),o=127,a=512;a>0;--a)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;t.w=i,t.X=s,t.i=o}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,r&&(r.X&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.xor4096=u}(0,t=n.nmd(t),n.amdD)},707:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this;e.next=function(){var t,n,r=e.x,o=e.i;return t=r[o],n=(t^=t>>>7)^t<<24,n^=(t=r[o+1&7])^t>>>10,n^=(t=r[o+3&7])^t>>>3,n^=(t=r[o+4&7])^t<<7,t=r[o+7&7],n^=(t^=t<<13)^t<<9,r[o]=n,e.i=o+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,r&&(r.x&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.xorshift7=u}(0,t=n.nmd(t),n.amdD)},920:function(t,e,n){var r;!function(t,o,a){function i(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new i(t),r=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&s(r,n),o.state=function(){return s(n,{})}),o}o&&o.exports?o.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,o))||(o.exports=r):this.xorwow=u}(0,t=n.nmd(t),n.amdD)},64:function(t,e,n){var r;!function(o,a,i){var s,u=256,c=i.pow(u,6),l=i.pow(2,52),d=2*l,f=u-1;function p(t,e,n){var r=[],f=m(b((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(a)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(u):(t=new Uint8Array(u),(o.crypto||o.msCrypto).getRandomValues(t)),y(t)}catch(t){var e=o.navigator,n=e&&e.plugins;return[+new Date,o,n,o.screen,y(a)]}}():t,3),r),p=new h(r),g=function(){for(var t=p.g(6),e=c,n=0;t<l;)t=(t+n)*u,e*=u,n=p.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return g.int32=function(){return 0|p.g(4)},g.quick=function(){return p.g(4)/4294967296},g.double=g,m(y(p.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&v(r,p),t.state=function(){return v(p,{})}),n?(i.random=t,e):t})(g,f,"global"in e?e.global:this==i,e.state)}function h(t){var e,n=t.length,r=this,o=0,a=r.i=r.j=0,i=r.S=[];for(n||(t=[n++]);o<u;)i[o]=o++;for(o=0;o<u;o++)i[o]=i[a=f&a+t[o%n]+(e=i[o])],i[a]=e;(r.g=function(t){for(var e,n=0,o=r.i,a=r.j,i=r.S;t--;)e=i[o=f&o+1],n=n*u+i[f&(i[o]=i[a=f&a+e])+(i[a]=e)];return r.i=o,r.j=a,n})(u)}function v(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function b(t,e){var n,r=[],o=typeof t;if(e&&"object"==o)for(n in t)try{r.push(b(t[n],e-1))}catch(t){}return r.length?r:"string"==o?t:t+"\0"}function m(t,e){for(var n,r=t+"",o=0;o<r.length;)e[f&o]=f&(n^=19*e[f&o])+r.charCodeAt(o++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(m(i.random(),a),t.exports){t.exports=p;try{s=n(42)}catch(t){}}else void 0===(r=function(){return p}.call(e,n,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},779:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.loadFromFiles=e.load=e.loadTruncatedMobileNet=e.CustomMobileNet=e.getTopKClasses=e.IMAGE_SIZE=void 0;var a=n(19),i=n(19),s=n(171),u=n(451),c=n(412),l=.25,d=.35;e.IMAGE_SIZE=224;var f=function(t){return t.packageVersion=t.packageVersion||c.version,t.packageName=t.packageName||"@teachablemachine/image",t.timeStamp=t.timeStamp||(new Date).toISOString(),t.userMetadata=t.userMetadata||{},t.modelName=t.modelName||"untitled",t.labels=t.labels||[],t.imageSize=t.imageSize||e.IMAGE_SIZE,t},p=function(t,e){if(1===t){if(.25!==e&&.5!==e&&.75!==e&&1!==e)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",l.toFixed(2)),l}else if(.35!==e&&.5!==e&&.75!==e&&1!==e)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d;return e},h=function(t){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return"string"!=typeof t?[3,3]:[4,fetch(t)];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),[3,4];case 3:if(!(r=t)||!Array.isArray(r.labels))throw new Error("Invalid Metadata provided");e=t,n.label=4;case 4:return[2,f(e)]}var r}))}))};function v(t,e,n){return void 0===n&&(n=3),r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,e.data()];case 1:return r=o.sent(),[2,a.tidy((function(){n=Math.min(n,r.length);for(var e=[],o=0;o<r.length;o++)e.push({value:r[o],index:o});e.sort((function(t,e){return e.value-t.value}));var a=new Float32Array(n),i=new Int32Array(n);for(o=0;o<n;o++)a[o]=e[o].value,i[o]=e[o].index;var s=[];for(o=0;o<i.length;o++)s.push({className:t[i[o]],probability:a[o]});return s}))]}}))}))}e.getTopKClasses=v;var b=function(){function t(t,e){this.model=t,this._metadata=f(e)}return Object.defineProperty(t,"EXPECTED_IMAGE_SIZE",{get:function(){return e.IMAGE_SIZE},enumerable:!1,configurable:!0}),t.prototype.getMetadata=function(){return this._metadata},t.prototype.getTotalClasses=function(){return this.model.output.shape[1]},t.prototype.getClassLabels=function(){return this._metadata.labels},t.prototype.predictTopK=function(t,e,n){return void 0===e&&(e=10),void 0===n&&(n=!1),r(this,void 0,void 0,(function(){var r,c,l,d=this;return o(this,(function(o){switch(o.label){case 0:return r=(0,u.cropTo)(t,this._metadata.imageSize,n),c=a.tidy((function(){var t=(0,s.capture)(r,d._metadata.grayscale);return d.model.predict(t)})),[4,v(this._metadata.labels,c,e)];case 1:return l=o.sent(),(0,i.dispose)(c),[2,l]}}))}))},t.prototype.predict=function(t,e){return void 0===e&&(e=!1),r(this,void 0,void 0,(function(){var n,r,c,l,d,f=this;return o(this,(function(o){switch(o.label){case 0:return n=(0,u.cropTo)(t,this._metadata.imageSize,e),[4,(r=a.tidy((function(){var t=(0,s.capture)(n,f._metadata.grayscale);return f.model.predict(t)}))).data()];case 1:for(c=o.sent(),l=[],d=0;d<c.length;d++)l.push({className:this._metadata.labels[d],probability:c[d]});return(0,i.dispose)(r),[2,l]}}))}))},t.prototype.dispose=function(){this.truncatedModel.dispose()},t}();e.CustomMobileNet=b,e.loadTruncatedMobileNet=function(t){return r(this,void 0,void 0,(function(){var n,r,i,s,u,c,f;return o(this,(function(o){switch(o.label){case 0:return n=function(t){if((t=t||{}).checkpointUrl&&t.trainingLayer)return(t.alpha||t.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[t.checkpointUrl,t.trainingLayer];if(t.version=t.version||1,1===t.version){t.alpha=t.alpha||l,t.alpha=p(t.version,t.alpha),console.log("Loading mobilenet ".concat(t.version," and alpha ").concat(t.alpha));var n=t.alpha.toFixed(2);return"1.00"===n&&(n="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_".concat(n,"_").concat(e.IMAGE_SIZE,"/model.json"),"conv_pw_13_relu"]}if(2===t.version)return t.alpha=t.alpha||d,t.alpha=p(t.version,t.alpha),console.log("Loading mobilenet ".concat(t.version," and alpha ").concat(t.alpha)),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_".concat(t.alpha.toFixed(2),"_").concat(e.IMAGE_SIZE,"_no_top/model.json"),"out_relu"];throw new Error("MobileNet V".concat(t.version," doesn't exist"))}(t),r=n[0],i=n[1],[4,a.loadLayersModel(r)];case 1:return s=o.sent(),t&&1===t.version?(u=s.getLayer(i),c=a.model({inputs:s.inputs,outputs:u.output}),(f=a.sequential()).add(c),f.add(a.layers.flatten()),[2,f]):(u=s.getLayer(i),c=a.model({inputs:s.inputs,outputs:u.output}),(f=a.sequential()).add(c),f.add(a.layers.globalAveragePooling2d({})),[2,f])}}))}))},e.load=function(t,e){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,a.loadLayersModel(t)];case 1:return n=o.sent(),e?[4,h(e)]:[3,3];case 2:return r=o.sent(),[3,4];case 3:r=null,o.label=4;case 4:return[2,new b(n,r)]}}))}))},e.loadFromFiles=function(t,e,n){return r(this,void 0,void 0,(function(){var r,i,s;return o(this,(function(o){switch(o.label){case 0:return[4,a.loadLayersModel(a.io.browserFiles([t,e]))];case 1:return r=o.sent(),[4,new Response(n).json()];case 2:return i=o.sent(),n?[4,h(i)]:[3,4];case 3:return s=o.sent(),[3,5];case 4:s=null,o.label=5;case 5:return[2,new b(r,s)]}}))}))}},365:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.createTeachable=e.TeachableMobileNet=void 0;var s=n(19),u=n(19),c=n(171),l=n(779),d=n(474);function f(t,e){for(var n,r=t.length,o=t.slice(),a=r-1;a>0;a-=1){var i=void 0;n=[o[i=e?Math.floor(e()*(a+1)):Math.floor(Math.random()*(a+1))],o[a]],o[a]=n[0],o[i]=n[1]}return o}var p=function(t){function e(e,n){var r=t.call(this,s.sequential(),n)||this;return r.totalSamples=0,r.examples=[],r.truncatedModel=e,r}return o(e,t),Object.defineProperty(e.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),e.prototype.addExample=function(t,e){return a(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(a){var i;return n="object"==typeof(i=e).dataId&&"object"==typeof i.shape?e:(0,c.capture)(e,this._metadata.grayscale),r=this.truncatedModel.predict(n),o=r.dataSync(),n.dispose(),r.dispose(),this.examples[t].push(o),this.totalSamples++,[2]}))}))},e.prototype.predict=function(e,n){return void 0===n&&(n=!1),a(this,void 0,void 0,(function(){return i(this,(function(r){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predict.call(this,e,n)]}))}))},e.prototype.predictTopK=function(e,n,r){return void 0===n&&(n=10),void 0===r&&(r=!1),a(this,void 0,void 0,(function(){return i(this,(function(o){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predictTopK.call(this,e,n,r)]}))}))},e.prototype.prepare=function(){for(var t in this.examples)if(0===t.length)throw new Error("Add some examples before training");var e=this.convertToTfDataset();this.trainDataset=e.trainDataset,this.validationDataset=e.validationDataset},e.prototype.convertToTfDataset=function(){for(var t=0;t<this.examples.length;t++)this.examples[t]=f(this.examples[t],this.seed);var e=[],n=[],r=function(t){var r,a,i,s=(r=t,a=o.numClasses,(i=new Array(a).fill(0))[r]=1,i),u=o.examples[t].length,c=u-Math.ceil(.15*u),l=o.examples[t].slice(0,c).map((function(t){return{data:t,label:s}})),d=o.examples[t].slice(c).map((function(t){return{data:t,label:s}}));e=e.concat(l),n=n.concat(d)},o=this;for(t=0;t<this.examples.length;t++)r(t);e=f(e,this.seed),n=f(n,this.seed);var a=s.data.array(e.map((function(t){return t.data}))),i=s.data.array(n.map((function(t){return t.data}))),u=s.data.array(e.map((function(t){return t.label}))),c=s.data.array(n.map((function(t){return t.label})));return{trainDataset:s.data.zip({xs:a,ys:u}),validationDataset:s.data.zip({xs:i,ys:c})}},e.prototype.save=function(t,e){return a(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.model.save(t,e)]}))}))},e.prototype.train=function(t,e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,r,o,a,c,l,d,f,p,h=this;return i(this,(function(i){switch(i.label){case 0:if(n=e.onTrainEnd||function(){},e.onTrainEnd=function(t){h.__stopTrainingResolve&&(h.__stopTrainingResolve(),h.__stopTrainingResolve=null),n(t)},this.isPrepared||this.prepare(),r=this.getLabels().length,u.util.assert(r===this.numClasses,(function(){return"Can not train, has ".concat(r," labels and ").concat(h.numClasses," classes")})),o=this.truncatedModel.outputs[0].shape.slice(1),a=s.util.sizeFromShape(o),c=this.seed?s.initializers.varianceScaling({seed:3.14}):s.initializers.varianceScaling({}),this.trainingModel=s.sequential({layers:[s.layers.dense({inputShape:[a],units:t.denseUnits,activation:"relu",kernelInitializer:c,useBias:!0}),s.layers.dense({kernelInitializer:c,useBias:!1,activation:"softmax",units:this.numClasses})]}),l=s.train.adam(t.learningRate),this.trainingModel.compile({optimizer:l,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(t.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return d=this.trainDataset.batch(t.batchSize),f=this.validationDataset.batch(t.batchSize),[4,this.trainingModel.fitDataset(d,{epochs:t.epochs,validationData:f,callbacks:e})];case 1:return i.sent(),(p=s.sequential()).add(this.truncatedModel),p.add(this.trainingModel),this.model=p,l.dispose(),[2,this.model]}}))}))},e.prototype.prepareDataset=function(){for(var t=0;t<this.numClasses;t++)this.examples[t]=[]},e.prototype.setLabel=function(t,e){this._metadata.labels[t]=e},e.prototype.setLabels=function(t){this._metadata.labels=t,this.prepareDataset()},e.prototype.getLabel=function(t){return this._metadata.labels[t]},e.prototype.getLabels=function(){return this._metadata.labels},e.prototype.setName=function(t){this._metadata.modelName=t},e.prototype.getName=function(){return this._metadata.modelName},e.prototype.stopTraining=function(){var t=this;return new Promise((function(e,n){t.trainingModel.stopTraining=!0,t.__stopTrainingResolve=e}))},e.prototype.dispose=function(){this.trainingModel.dispose(),t.prototype.dispose.call(this)},e.prototype.calculateAccuracyPerClass=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,o,u,c,l,d,f,p,h,v,b,m,y,g,w,x=this;return i(this,(function(_){switch(_.label){case 0:return t=this.validationDataset.mapAsync((function(t){return a(x,void 0,void 0,(function(){return i(this,(function(e){return[2,t.xs]}))}))})),e=this.validationDataset.mapAsync((function(t){return a(x,void 0,void 0,(function(){return i(this,(function(e){return[2,t.ys]}))}))})),n=Math.min(e.size,32),r=Math.ceil(e.size/n),o=t.batch(n),u=e.batch(n),[4,o.iterator()];case 1:return c=_.sent(),[4,u.iterator()];case 2:l=_.sent(),d=[],f=[],w=0,_.label=3;case 3:return w<r?[4,c.next()]:[3,7];case 4:return p=_.sent(),h=this.trainingModel.predict(p.value),v=h.argMax(1),d.push(v),[4,l.next()];case 5:b=_.sent(),m=b.value.argMax(1),f.push(m),p.value.dispose(),h.dispose(),b.value.dispose(),_.label=6;case 6:return w++,[3,3];case 7:if(y=s.concat(f),g=s.concat(d),1!==r)for(w=0;w<d.length;w++)d[w].dispose(),f[w].dispose();return[2,{reference:y,predictions:g}]}}))}))},e.prototype.setSeed=function(t){this.seed=d(t)},e}(l.CustomMobileNet);e.TeachableMobileNet=p,e.createTeachable=function(t,e){return a(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,(0,l.loadTruncatedMobileNet)(e)];case 1:return n=r.sent(),[2,new p(n,t)]}}))}))}},451:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cropTo=e.resizeMinTo=e.resizeMaxTo=e.resize=void 0;var n=function(){return document.createElement("canvas")};function r(t,e,r){return void 0===r&&(r=n()),r.width=t.width*e,r.height=t.height*e,r.getContext("2d").drawImage(t,0,0,r.width,r.height),r}e.resize=r,e.resizeMaxTo=function(t,e,o){return void 0===o&&(o=n()),r(t,e/Math.max(t.width,t.height),o)},e.resizeMinTo=function(t,e,o){return void 0===o&&(o=n()),r(t,e/Math.min(t.width,t.height),o)},e.cropTo=function(t,e,r,o){void 0===r&&(r=!1),void 0===o&&(o=n());var a=t.width,i=t.height;t instanceof HTMLVideoElement&&(a=t.videoWidth,i=t.videoHeight);var s=e/Math.min(a,i),u=Math.ceil(a*s),c=Math.ceil(i*s),l=u-e,d=c-e;o.width=o.height=e;var f=o.getContext("2d");return f.drawImage(t,-1*~~(l/2),-1*~~(d/2),u,c),r&&(f.scale(-1,1),f.drawImage(o,-1*e,0)),o}},171:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cropTensor=e.capture=void 0;var r=n(19);function o(t,e,n){var o=Math.min(t.shape[0],t.shape[1]),a=t.shape[0]/2-o/2,i=t.shape[1]/2-o/2;if(e&&!n){var s=t.slice([a,i,0],[o,o,3]);s=s.reshape([o*o,1,3]);return s=(s=r.mul(s,[.2989,.587,.114])).reshape([o,o,3]),s=r.sum(s,-1),s=r.expandDims(s,-1)}return t.slice([a,i,0],[o,o,3])}e.capture=function(t,e){return r.tidy((function(){return o(r.browser.fromPixels(t),e).expandDims(0).toFloat().div(r.scalar(127)).sub(r.scalar(1))}))},e.cropTensor=o},114:function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var o,a=arguments.length,i=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(a<3?o(i):a>3?o(e,n,i):o(e,n))||i);return a>3&&i&&Object.defineProperty(e,n,i),i},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Webcam=void 0;var i=n(791),s=n(451),u={facingMode:"user",frameRate:24};e.Webcam=function(){function t(t,e,n){void 0===t&&(t=400),void 0===e&&(e=400),void 0===n&&(n=!1),this.width=t,this.height=e,this.flip=n}return t.prototype.getWebcam=function(t){if(void 0===t&&(t={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");t.width=640;var e=function(t){return t.facingMode=t.facingMode||u.facingMode,t.frameRate=t.frameRate||u.frameRate,t.aspectRatio=t.aspectRatio||u.aspectRatio,t}(t),n=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:e}).then((function(t){return n.srcObject=t,n.addEventListener("loadedmetadata",(function(t){var e=n.videoWidth,r=n.videoHeight;n.width=e,n.height=r})),n}),(function(){return Promise.reject("Could not open your camera. You may have denied access.")}))},t.prototype.setup=function(t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return this.webcam?[3,2]:(e=this,[4,this.getWebcam(t)]);case 1:e.webcam=n.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),n.label=2;case 2:return[2]}}))}))},t.prototype.play=function(){return this.webcam.play()},t.prototype.pause=function(){this.webcam.pause()},t.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},t.prototype.update=function(){this.renderCameraToCanvas()},t.prototype.stopStreamedVideo=function(t){t.srcObject.getTracks().forEach((function(t){t.stop()})),t.srcObject=null},t.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var t=this.canvas.getContext("2d");if(0!==this.webcam.videoWidth){var e=(0,s.cropTo)(this.webcam,this.width,this.flip);t.drawImage(e,0,0)}}},r([i.default],t.prototype,"getWebcam",null),r([i.default],t.prototype,"setup",null),r([i.default],t.prototype,"play",null),r([i.default],t.prototype,"pause",null),r([i.default],t.prototype,"stop",null),r([i.default],t.prototype,"update",null),r([i.default],t.prototype,"stopStreamedVideo",null),r([i.default],t.prototype,"renderCameraToCanvas",null),t}()},412:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0;e.version="0.8.6"},19:t=>{"use strict";t.exports=tf},42:()=>{}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var r={};(()=>{"use strict";var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.Webcam=t.createTeachable=t.TeachableMobileNet=t.loadTruncatedMobileNet=t.loadFromFiles=t.load=t.CustomMobileNet=t.IMAGE_SIZE=void 0;var e=n(779);Object.defineProperty(t,"IMAGE_SIZE",{enumerable:!0,get:function(){return e.IMAGE_SIZE}}),Object.defineProperty(t,"CustomMobileNet",{enumerable:!0,get:function(){return e.CustomMobileNet}}),Object.defineProperty(t,"load",{enumerable:!0,get:function(){return e.load}}),Object.defineProperty(t,"loadFromFiles",{enumerable:!0,get:function(){return e.loadFromFiles}}),Object.defineProperty(t,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return e.loadTruncatedMobileNet}});var o=n(365);Object.defineProperty(t,"TeachableMobileNet",{enumerable:!0,get:function(){return o.TeachableMobileNet}}),Object.defineProperty(t,"createTeachable",{enumerable:!0,get:function(){return o.createTeachable}});var a=n(114);Object.defineProperty(t,"Webcam",{enumerable:!0,get:function(){return a.Webcam}});var i=n(412);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return i.version}})})(),tmImage=r})();